Linux内核及驱动开发考试A卷

一．多项或单项选择题(共12题，前8题每题3分，后4题每题4分，共40分)
 1.在编译一个外部模块时，Makefile 中 指定的M参数代表的含义表述准确的是( C )
	A: 内核源码所在路径
	B: 生成的外部模块名称
	C: 要编译的模块所在路径
	D: 使用的编译工具链前缀

2. Linux系统中将设备进行分类管理，下列设备中哪些属于字符设备( A D)
	A: 键盘
	B: 硬盘
	C: 闪存设备
	D: 帧缓存设备
	E: 网卡

3. 下列说法中正确的是:（ABD）
	A: 通过静态编译可以形成内部模块
	B: 通过动态编译可以形成外部模块
	C: 通过动态编译可以形成内部模块
	D: 外部模块编译时源码不在内核源码树中

4. 下列哪些命令可以加载外部模块（C）
	A: lsmod
	B: rmmod
	C: insmod
	D: modprobe

5. 在ARM平台的Linux内核中，哪些情况会导致临界资源的竟态？(ABD)
	A: 对称多处理器（SMP）的多个CPU
	B: 单CPU内进程与抢占它的进程
	C: 中断与中断之间
	D: 中断与进程之间

6. Linux系统中设备节点可以创建在(D)
A: 只能在/dev目录下
	B: 只能在根目录下
	C: 只能在/temp目录下
	D: 任意目录下


7. 当platform_device和platform_driver匹配时，会执行的函数是(C)
A: 驱动模块加载函数
	B: 驱动模块卸载函数
	C: 驱动的probe函数
	D: 驱动的remove函数


8. 中断标志位中表示共享中断的宏是(B)
A: IRQF_DISABLED
	B: IRQF_SHARED
	C: IRQF_SAMPLE_RANDOM
	D: IRQF_TRIGGER_FALLING

9. 通常情况下，kmalloc函数能分配的最大内存是(C)
A: 4K
	B: 64K
	C: 128K
	D: 4M

10. 以下机制中，可以在Linux设备驱动程序中实现延迟机制的是(ACD)
A: tasklet
	B: 等待队列
	C: 内核定时器
	D: 工作队列

11. How do I know the version of the current linux kernel?(D)
A: ls
	B: pwd
	C: uname
	D: uname–r

12. 四个人过河，只有一个手电筒，单独过河时间分别为：1分钟，2分钟，5分钟，10分钟。河上的木桥每次只能通过2个人。在桥上的人手中必须要有手电筒,且过桥过程中不能停留和折返。问最快多长时间四个人都能到达对岸？(D)
A: 20分钟
	B: 19分钟
	C: 18分钟
	D: 17分钟    2 + 1 + 10 + 2 + 2

二．简答题(共6道，每题10分，共60分)
13. 简述命令mknod   /dev/zero   c   1   5 的作用和命令各部分的含义，并写出创建一个块设备节点的命令。
mknod		//创建设备节点命令
/dev/zero 	//指定要创建的设备节点的名称
c 			//要创建的设备节点为字符设备节点
1	//指定主设备号
5			//指定次设备号


创建块设备节点:mknod /dev/block1 b 254 2



14. 内核中的延迟工作机制有哪些？

软中断、tasklet、工作队列和内核定时器  mdelay


16. 请简述linux内核中断处理分成上半部分和下半部分的原因，为何要分？如何实现？
中断处理函数要求不能睡眠，且尽量精简，但是事实上我们希望中断处理函数中要做的事情非常多，所以中断处理函数既要执行的快，又要做很多的事情，两者之间是存在矛盾的。为了解决这种问题，需要将中断处理分为上下半部：
上半部中做一些紧急的，不耗时的操作
下半部中执行一些耗时的操作，比如数据拷贝。
可以使用tasklet和工作队列来实现。


17. Linux平台下，如何让字符设备驱动支持阻塞与非阻塞IO模型，以read操作为例，编写代码简要说明

	if(filp->f_flags& O_NONBLOCK){//如果为真则为非阻塞访问方式
		return–EAGIN;
	//睡眠，如果被唤醒判断是否是被信号唤醒，如果是则返回-ERESTARTSYS
	Wait_event_interruptible(wq,condition);
copy_to_user(buf, dev->data, count);


18. 请列举三个以上的内核中申请内存的函数，并说明他们之间的区别
__get_free_page/__get_free_pages  以页为单位申请物理空间连续的内存
kmalloc 以2的n次幂为单位申请物理空间连续的内存,128K
vmalloc 申请指定字节大小的内存，申请的内存在虚拟地址空间上连续，但不保证物理地址空间连续。
